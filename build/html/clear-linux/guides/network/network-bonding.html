




<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Combine multiple interfaces</title>
  

<link rel="icon" type="image/png" sizes="192x192" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_android_192x192.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_180x180.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_152x152.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_96x96.png" />
<meta name="google-site-verification" content="xDIK6ZRF9BKNIeBUstAHF3zS6bpi2eCjBHemCQAEH8o" />
<meta name="msapplication-TileImage" href="sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_microsoft_144x144.png" />
<meta name="theme-color" content="#7DD2F7" />
<link rel="icon" type="image/png" sizes="16x16" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_16x16.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_144x144.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_120x120.png" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<link rel="shortcut icon" href="/sites/all/themes/custom/clearlinux_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="apple-touch-icon" sizes="57x57" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_57x57.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_76x76.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_72x72.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_60x60.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_114x114.png" />

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/main.css" type="text/css" />
  

  

  

    <link rel="stylesheet" href="/sites/all/themes/custom/clearlinux_theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/overrides.css" type="text/css" />
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Documentation for Clear Linux* Project for Intel(r) Architecture" href="../../../index.html"/>
        <link rel="up" title="Network guide" href="network.html"/>
        <link rel="next" title="Build a custom Clear Linux based Docker container image" href="custom-clear-container.html"/>
        <link rel="prev" title="Enable DPDK support on OpenvSwitch" href="ovs-dpdk.html"/>
     
    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
  

  
  <script src="/sites/all/themes/custom/clearlinux_theme/js/modernizr.custom.19994.js"></script>

</head>

<body role="document" class="section-documentation">
  <div id="wrapper">
  <header>
    <div id="o1-header">
      <div class="o1-logo-container hidden-xs">
        <div class="container"><a href="http://01.org" class="o1-logo ext" target="_blank"></a></div>
      </div>
      <div class="project-header container clearfix">
        <div class="left inline">
          <a href="/" id="project-name">
            <span id="project-name-left">Clear Linux&nbsp; <sup>*</sup></span>
            <span id="project-name-right">Project</span>
            <span id="project-name-bottom">for Intel* Architecture</span>
          </a>
        </div>
        <div class="right">
          <div class="mobile-menu"></div>
            <div class="region region-header">
              <div id="block-system-main-menu" class="block block-system block-menu">
                <ul class="menu">
                  <li class="first leaf"><a href="https://download.clearlinux.org" title="Downloads" target="_blank">Downloads</a></li>
                  <li class="collapsed"><a href="/features" title="Features">Features</a></li>
                  <li class="collapsed"><a href="/documentation" title="Documentation" class="active">Documentation</a></li>
                </ul>
              </div>
              <div id="block-menu-menu-get-involved" class="block block-menu">
                <h4>Get Involved</h4>
                <ul class="menu">
                  <li class="first leaf"><a href="http://freenode.net/" target="_blank">IRC #clearlinux</a></li>
                  <li class="leaf"><a href="https://lists.clearlinux.org/mailman/listinfo/dev">Mailing list</a></li>
                  <li class="last leaf"><a href="/blogs">Blogs</a></li>
                </ul>
              </div>
            </div>
                    <ul class="nav-tools">
            <li><a href="/search"><i class="fa fa-search"></i></a></li>
            <!--<li><i class="fa fa-mail-forward"></i></li>-->
          </ul>
        </div>
      </div>
    </div>
</header>
      
      <div class="main-content">
        <div id="site-breadcrumb">
            <div class="container">





<div id="site-breadcrumb">
  <h2 class="element-invisible"></h2>
  <div class="breadcrumb">
    <a href="/">Home</a> » <a href="../../../index.html">Documentation</a> » Combine multiple interfaces
  </div>
</div></div>
          </div>
        <div class="container clearfix">
          <div class="row">
           <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="region region-content">
              <div class="content">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-md-4 col-sm-4 col-xs-12">
                      <div class="row"><div class="col-md-12 col-sm-12 col-xs-12"><sidebar>
  <h2>Content Map</h2>
      
      
      
      
      
      
      
      
      <ul class="custom-dropdown-menu">
<li class="menu-item-open parent-item"><a class="reference internal" href="../../clear-linux.html">Clear Linux* Project for Intel® Architecture</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="../../get-started/get-started.html">Get started</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../concepts/concepts.html">Concepts</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../guides.html">Guides</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../reference/reference.html">Reference</a></li>
</ul>
</li>
<li class="menu-item-closed parent-item"><a class="reference internal" href="../../../clear-containers/clear-containers.html">Intel® Clear Containers</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="../../../clear-containers/getting-started.html">Clear Containers getting started guide</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../../clear-containers/architecture-overview.html">Architecture Overview</a></li>
</ul>
</li>
</ul>

</sidebar></div></div>
                      <div class="row"><div class="col-md-12 col-sm-12 col-xs-12">
<br />
<div id="searchbox" role="search">
  <h2>Quick Search</h2>
  <form class="search" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="submit" value="Go" class="pull-right">
  </form>
</div></div></div>
                    </div>
                    <div class="col-md-8 col-sm-8 col-xs-12">
  <div class="section" id="combine-multiple-interfaces">
<span id="network-bonding"></span><h1>Combine multiple interfaces</h1>
<p>Network bonding is a technique for combining multiple network interfaces into
a single, logical interface, providing some redundancy and bandwidth
aggregation.</p>
<p>Clear Linux* OS for Intel® Architecture includes the <a class="reference external" href="https://www.kernel.org/doc/Documentation/networking/bonding.txt">bonding</a> and <a class="reference external" href="https://www.kernel.org/doc/Documentation/networking/team.txt">team</a> drivers. The guide example provided
below shows how to configure systemd to use the <code class="docutils literal"><span class="pre">bonding</span></code> driver.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All commands in this guide must be run as root.</p>
</div>
<ol class="arabic">
<li><p class="first">Create the <code class="docutils literal"><span class="pre">/etc/systemd/network</span></code> directory (if it doesn&#8217;t already exist):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> mkdir -p /etc/systemd/network
</pre></div>
</div>
<p>This directory contains the configuration files and network settings
for the virtual device and its underlying physical interfaces.</p>
</li>
<li><p class="first">Configure systemd to create a virtual network device, <code class="docutils literal"><span class="pre">bond1</span></code>. Use a text
editor to create a file named <code class="docutils literal"><span class="pre">30-bond1.netdev</span></code> as shown here:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[NetDev]</span>
<span class="na">Name</span><span class="o">=</span><span class="s">bond1</span>
<span class="na">Kind</span><span class="o">=</span><span class="s">bond</span>

<span class="k">[Bond]</span>
<span class="na">Mode</span><span class="o">=</span><span class="s">802.3ad</span>
<span class="na">TransmitHashPolicy</span><span class="o">=</span><span class="s">layer3+4</span>
<span class="na">MIIMonitorSec</span><span class="o">=</span><span class="s">1s</span>
<span class="na">LACPTransmitRate</span><span class="o">=</span><span class="s">fast</span>
</pre></div>
</div>
<p>The syntax for this file is defined in the <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.netdev.html">systemd.netdev</a> manpage.
<a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.netdev.html#id-1.20.10">This example</a> may be used verbatim, or tuned to your particular
requirements.  Note that <code class="docutils literal"><span class="pre">802.3ad</span></code> mode requires explicit support from
your NICs and network switch. This and other modes may also require
additional configuration of your network switch.</p>
</li>
</ol>
<ol class="arabic" start="3">
<li><p class="first">Configure the slave interfaces, assigning them to the new <code class="docutils literal"><span class="pre">bond1</span></code> device,
using the syntax in <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.network.html">systemd.network</a>, and in a text file named
<code class="docutils literal"><span class="pre">30-bond1-enp1s0.network</span></code> as shown here:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[Match]</span>
<span class="na">Name</span><span class="o">=</span><span class="s">enp1s0f*</span>

<span class="k">[Network]</span>
<span class="na">Bond</span><span class="o">=</span><span class="s">bond1</span>

<span class="k">[Link]</span>
<span class="na">MTUBytes</span><span class="o">=</span><span class="s">9000</span>
</pre></div>
</div>
<p>This example demonstrates bonding all four ports of a quad-port NIC, with
names in the range <code class="docutils literal"><span class="pre">enp1s0f0-enp1s0f3</span></code>, allowing the use of a single file
with a wildcard match. You may also create a separate file for each NIC,
particularly if they have names that are not wildcard-friendly. This
configuration assigns each NIC as a slave of <code class="docutils literal"><span class="pre">bond1</span></code>. For best results,
do not assign addresses or DHCP support to the individual NICs.</p>
<p>This example also enables jumbo frames of up to 9000 bytes to optimize large
data transfers on the local network. Again, your NICs and switch must
support jumbo frames, and your switch may require additional configuration.</p>
</li>
<li><p class="first">Define the network configuration for the bonded interface in a file named
<code class="docutils literal"><span class="pre">30-bond1.network</span></code> as shown here:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[Match]</span>
<span class="na">Name</span><span class="o">=</span><span class="s">bond1</span>

<span class="k">[Network]</span>
<span class="na">BindCarrier</span><span class="o">=</span><span class="s">enp1s0f0 enp1s0f1 enp1s0f2 enp1s0f3</span>
<span class="na">Address</span><span class="o">=</span><span class="s">192.168.1.201/24</span>

<span class="k">[Link]</span>
<span class="na">MTUBytes</span><span class="o">=</span><span class="s">9000</span>
</pre></div>
</div>
<p>Since <code class="docutils literal"><span class="pre">bond1</span></code> is a virtual interface, it has no concept of physical link
status. The <code class="docutils literal"><span class="pre">BindCarrier</span></code> directive indicates that the link status of this
interface is determined by the status of the listed slave devices.</p>
<p>This is the logical interface, so assign it an IP address. DHCP is more
complicated with bonded interfaces, and is not covered in this example.</p>
<p>This file also enables jumbo frames of up to 9000 bytes. This option must be
enabled for all slave interfaces <em>and</em> the bonded interface, in order to take
effect.</p>
</li>
<li><p class="first">Apply the new network configuration:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> systemctl restart systemd-networkd
</pre></div>
</div>
<p>The MTU settings will not take effect until a reboot, or if you explicitly
apply them via <code class="docutils literal"><span class="pre">ifconfig</span></code>, for example.</p>
</li>
</ol>
</div>

</div>
                  </div>
                </div>
              </div>
            </div>
           </div>
          </div>
        </div>
      </div>
      <footer id="footer">
    <div class="project-footer container clearfix">
      <span class="intel-sw-logo"></span>
      <div class="mobile-menu"></div>
                <div class="region region-footer">
    <div id="block-menu-menu-footer-menu" class="block block-menu">


  <ul class="menu"><li class="first leaf"><a href="/about/privacy-policy">Privacy Policy</a></li>
<li class="leaf"><a href="mailto:dev@lists.clearlinux.org" class="mailto">Contact us</a></li>
<li class="leaf"><a href="/about/terms-service">Terms of Service</a></li>
<li class="leaf"><a href="http://www.intel.com/content/www/us/en/legal/trademarks.html" target="_blank" class="ext">* Trademarks</a></li>
<li class="last leaf"><a href="http://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html" target="_blank" class="ext">Cookies</a></li>
</ul>
</div>
<div id="block-menu-block-1" class="block block-menu-block">


  <div class="menu-block-wrapper menu-block-1 menu-name-menu-social-media parent-mlid-0 menu-level-1">
  <ul class="menu"><li class="first leaf menu-mlid-8277"><a href="https://twitter.com/clearlinux" class="social-media icon twitter">Twitter</a></li>
<li class="leaf menu-mlid-8286"><a href="https://plus.google.com/u/2/b/110130641055512104222/110130641055512104222/posts/p/pub?_ga=1.28912252.1365239857.1461340816" class="social-media icon googleplus">Google +</a></li>
<li class="last leaf menu-mlid-8279"><a href="https://github.com/clearlinux" class="social-media icon github">Github</a></li>
</ul></div>

</div>
  </div>
    </div>
    <div class="footer-copyright">
      <small>Copyright © 2016 Intel Corporation. All rights reserved</small> <br>
      <small>*Other names and brands may be claimed as the property of others</small>
    </div>
</footer>
    </div>
    

      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'0.1',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/js/affix.js"></script>
        <script type="text/javascript" src="../../../_static/js/sorttable.js"></script>
        <script type="text/javascript" src="../../../_static/js/project.js"></script>

    

    
    
      <script type="text/javascript" src="../../../_static/js/theme.js"></script>
    

    
    

     <script type="text/javascript">
    jQuery(function() { Search.loadIndex("../../../searchindex.js"); });
    </script>
    
    <script type="text/javascript" id="searchindexloader"></script>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61272224-1', 'auto');
  ga('send', 'pageview');
  </script>
   
</body>
</html>
