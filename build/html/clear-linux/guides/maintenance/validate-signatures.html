




<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Validate signatures</title>
  

<link rel="icon" type="image/png" sizes="192x192" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_android_192x192.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_180x180.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_152x152.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_96x96.png" />
<meta name="google-site-verification" content="xDIK6ZRF9BKNIeBUstAHF3zS6bpi2eCjBHemCQAEH8o" />
<meta name="msapplication-TileImage" href="sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_microsoft_144x144.png" />
<meta name="theme-color" content="#7DD2F7" />
<link rel="icon" type="image/png" sizes="16x16" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_16x16.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_144x144.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_120x120.png" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<link rel="shortcut icon" href="/sites/all/themes/custom/clearlinux_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="apple-touch-icon" sizes="57x57" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_57x57.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_76x76.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_72x72.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_60x60.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_114x114.png" />

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/main.css" type="text/css" />
  

  

  

    <link rel="stylesheet" href="/sites/all/themes/custom/clearlinux_theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/overrides.css" type="text/css" />
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Documentation for Clear Linux* Project for Intel(r) Architecture" href="../../../index.html"/>
        <link rel="up" title="Maintenance guide" href="maintenance.html"/>
        <link rel="next" title="Enable and disable telemetry in Clear Linux" href="telemetry-enable.html"/>
        <link rel="prev" title="Use mixer tool" href="mixer.html"/>
     
    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
  

  
  <script src="/sites/all/themes/custom/clearlinux_theme/js/modernizr.custom.19994.js"></script>

</head>

<body role="document" class="section-documentation">
  <div id="wrapper">
  <header>
    <div id="o1-header">
      <div class="o1-logo-container hidden-xs">
        <div class="container"><a href="http://01.org" class="o1-logo ext" target="_blank"></a></div>
      </div>
      <div class="project-header container clearfix">
        <div class="left inline">
          <a href="/" id="project-name">
            <span id="project-name-left">Clear Linux&nbsp; <sup>*</sup></span>
            <span id="project-name-right">Project</span>
            <span id="project-name-bottom">for Intel* Architecture</span>
          </a>
        </div>
        <div class="right">
          <div class="mobile-menu"></div>
            <div class="region region-header">
              <div id="block-system-main-menu" class="block block-system block-menu">
                <ul class="menu">
                  <li class="first leaf"><a href="https://download.clearlinux.org" title="Downloads" target="_blank">Downloads</a></li>
                  <li class="collapsed"><a href="/features" title="Features">Features</a></li>
                  <li class="collapsed"><a href="/documentation" title="Documentation" class="active">Documentation</a></li>
                </ul>
              </div>
              <div id="block-menu-menu-get-involved" class="block block-menu">
                <h4>Get Involved</h4>
                <ul class="menu">
                  <li class="first leaf"><a href="http://freenode.net/" target="_blank">IRC #clearlinux</a></li>
                  <li class="leaf"><a href="https://lists.clearlinux.org/mailman/listinfo/dev">Mailing list</a></li>
                  <li class="last leaf"><a href="/blogs">Blogs</a></li>
                </ul>
              </div>
            </div>
                    <ul class="nav-tools">
            <li><a href="/search"><i class="fa fa-search"></i></a></li>
            <!--<li><i class="fa fa-mail-forward"></i></li>-->
          </ul>
        </div>
      </div>
    </div>
</header>
      
      <div class="main-content">
        <div id="site-breadcrumb">
            <div class="container">





<div id="site-breadcrumb">
  <h2 class="element-invisible"></h2>
  <div class="breadcrumb">
    <a href="/">Home</a> » <a href="../../../index.html">Documentation</a> » Validate signatures
  </div>
</div></div>
          </div>
        <div class="container clearfix">
          <div class="row">
           <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="region region-content">
              <div class="content">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-md-4 col-sm-4 col-xs-12">
                      <div class="row"><div class="col-md-12 col-sm-12 col-xs-12"><sidebar>
  <h2>Content Map</h2>
      
      
      
      
      
      
      
      
      <ul class="custom-dropdown-menu">
<li class="menu-item-open parent-item"><a class="reference internal" href="../../clear-linux.html">Clear Linux* Project for Intel® Architecture</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="../../get-started/get-started.html">Get started</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../concepts/concepts.html">Concepts</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../guides.html">Guides</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../reference/reference.html">Reference</a></li>
</ul>
</li>
<li class="menu-item-closed parent-item"><a class="reference internal" href="../../../clear-containers/clear-containers.html">Intel® Clear Containers</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="../../../clear-containers/getting-started.html">Clear Containers getting started guide</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="../../../clear-containers/architecture-overview.html">Architecture Overview</a></li>
</ul>
</li>
</ul>

</sidebar></div></div>
                      <div class="row"><div class="col-md-12 col-sm-12 col-xs-12">
<br />
<div id="searchbox" role="search">
  <h2>Quick Search</h2>
  <form class="search" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="submit" value="Go" class="pull-right">
  </form>
</div></div></div>
                    </div>
                    <div class="col-md-8 col-sm-8 col-xs-12">
  <div class="section" id="validate-signatures">
<span id="id1"></span><h1>Validate signatures</h1>
<p>Clear Linux* OS for Intel® Architecture offers a way to validate the content of an image or an update. All
validation of content works by creating and signing a hash. A valid signature
creates a chain of trust. A broken chain of trust, seen as an invalid
signature, means the content is not valid.</p>
<p>This guide covers how to validate the contents of an image, which is a manual
process, and describes the automatic process <code class="docutils literal"><span class="pre">swupd</span></code> performs internally to
validate an update.</p>
<div class="section" id="image-content-validation">
<h2>Image content validation</h2>
<p>For the outlined steps, the installer image of the latest release of Clear Linux is
used for illustrative purposes. You may use any image of Clear Linux you choose.</p>
<ol class="arabic">
<li><p class="first">Download the image, the signature of the SHA512 sum of the image, and the
Clear Linux certificate used for signing the SHA512 sum.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> Image
<span class="go">curl -O https://download.clearlinux.org/current/clear-$(curl https://download.clearlinux.org/latest)-installer.img.xz</span>
<span class="gp">#</span> Signature of SHA512 sum of image
<span class="go">curl -O https://download.clearlinux.org/current/clear-$(curl https://download.clearlinux.org/latest)-installer.img.xz-SHA512SUMS.sig</span>
<span class="gp">#</span> Clear Linux certificate
<span class="go">curl -O https://download.clearlinux.org/releases/$(curl https://download.clearlinux.org/latest)/clear/ClearLinuxRoot.pem</span>
</pre></div>
</div>
</li>
<li><p class="first">Generate the SHA256 sum of the Clear Linux certificate.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">sha256sum ClearLinuxRoot.pem</span>
</pre></div>
</div>
</li>
<li><p class="first">Ensure the generated SHA256 sum of the Clear Linux certificate matches the
following SHA256 sum to verify the integrity of the certificate.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">4b0ca67300727477913c331ff124928a98bcf2fb12c011a855f17cd73137a890  ClearLinuxRoot.pem</span>
</pre></div>
</div>
</li>
<li><p class="first">Generate the SHA512 sum of the image and save it to a file.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">sha512sum ./clear-$(curl https://download.clearlinux.org/latest)-installer.img.xz &gt; sha512sum.out</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The <code class="docutils literal"><span class="pre">./</span></code> in the file name must be included because it is part of the
SHA512 sum of the image. Without it, the validation of the signature
of the image will fail.</p>
</div>
</li>
<li><p class="first">Ensure the signature of the SHA512 sum of the image was created using the
Clear Linux certificate. This validates the image is trusted and it has not
been modified.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">openssl smime -verify -in clear-$(curl https://download.clearlinux.org/latest)-installer.img.xz-SHA512SUMS.sig -inform der -content sha512sum.out -CAfile ClearLinuxRoot.pem</span>
</pre></div>
</div>
</li>
<li><p class="first">The output should contain <code class="docutils literal"><span class="pre">Verification</span> <span class="pre">successful</span></code>. If the output
contains <code class="docutils literal"><span class="pre">bad_signature</span></code> anywhere, then the image is not trustworthy.</p>
</li>
</ol>
</div>
<div class="section" id="update-content-validation">
<h2>Update content validation</h2>
<p><code class="docutils literal"><span class="pre">swupd</span></code> validates all update content automatically before applying the
update content. The process <code class="docutils literal"><span class="pre">swupd</span></code> follows internally is illustrated here
with manual steps using the latest Clear Linux release. There is no need to perform
these steps manually when performing a <code class="docutils literal"><span class="pre">swupd</span> <span class="pre">update</span></code>.</p>
<ol class="arabic">
<li><p class="first">Download the <abbr title="top-level manifest">MoM</abbr>, the signature of the MoM,
and the Swupd certificate used for signing the signature of the MoM.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> MoM
<span class="go">curl -O https://download.clearlinux.org/update/$(curl https://download.clearlinux.org/latest)/Manifest.MoM</span>
<span class="gp">#</span> Signature of MoM
<span class="go">curl -O https://download.clearlinux.org/update/$(curl https://download.clearlinux.org/latest)/Manifest.sig</span>
<span class="gp">#</span> Swupd certificate
<span class="go">curl -O https://download.clearlinux.org/releases/$(curl https://download.clearlinux.org/latest)/clear/Swupd_Root.pem</span>
</pre></div>
</div>
</li>
<li><p class="first">Generate the SHA256 sum of the Swupd certificate.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">sha256sum Swupd_Root.pem</span>
</pre></div>
</div>
</li>
<li><p class="first">Ensure the generated SHA256 sum of the Swupd certificate matches following
SHA256 sum to verify the integrity of the certificate.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">ff06fc76ec5148040acb4fcb2bc8105cc72f1963b55de0daf3a4ed664c6fe72c  Swupd_Root.pem</span>
</pre></div>
</div>
</li>
<li><p class="first">Ensure the signature of the MoM was created using the Swupd certificate.
This signature validates the update content is trustworthy and has not been
modified.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">openssl smime -verify -in Manifest.MoM.sig -inform der -content Manifest.MoM -CAfile Swupd_Root.pem</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The SHA512 sum of the MoM is not generated and then signed. Instead, the
MoM is signed directly because it is small in size compared to an image of
Clear Linux.</p>
</div>
</li>
<li><p class="first">The output should contain <code class="docutils literal"><span class="pre">Verification</span> <span class="pre">successful</span></code>. If the output
contains <code class="docutils literal"><span class="pre">bad_signature</span></code> anywhere, then the MoM cannot be trusted.
Because the MoM contains a list of hashes for bundle manifests, if the MoM
cannot be trusted, then the bundle content cannot be trusted.</p>
</li>
</ol>
</div>
</div>

</div>
                  </div>
                </div>
              </div>
            </div>
           </div>
          </div>
        </div>
      </div>
      <footer id="footer">
    <div class="project-footer container clearfix">
      <span class="intel-sw-logo"></span>
      <div class="mobile-menu"></div>
                <div class="region region-footer">
    <div id="block-menu-menu-footer-menu" class="block block-menu">


  <ul class="menu"><li class="first leaf"><a href="/about/privacy-policy">Privacy Policy</a></li>
<li class="leaf"><a href="mailto:dev@lists.clearlinux.org" class="mailto">Contact us</a></li>
<li class="leaf"><a href="/about/terms-service">Terms of Service</a></li>
<li class="leaf"><a href="http://www.intel.com/content/www/us/en/legal/trademarks.html" target="_blank" class="ext">* Trademarks</a></li>
<li class="last leaf"><a href="http://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html" target="_blank" class="ext">Cookies</a></li>
</ul>
</div>
<div id="block-menu-block-1" class="block block-menu-block">


  <div class="menu-block-wrapper menu-block-1 menu-name-menu-social-media parent-mlid-0 menu-level-1">
  <ul class="menu"><li class="first leaf menu-mlid-8277"><a href="https://twitter.com/clearlinux" class="social-media icon twitter">Twitter</a></li>
<li class="leaf menu-mlid-8286"><a href="https://plus.google.com/u/2/b/110130641055512104222/110130641055512104222/posts/p/pub?_ga=1.28912252.1365239857.1461340816" class="social-media icon googleplus">Google +</a></li>
<li class="last leaf menu-mlid-8279"><a href="https://github.com/clearlinux" class="social-media icon github">Github</a></li>
</ul></div>

</div>
  </div>
    </div>
    <div class="footer-copyright">
      <small>Copyright © 2016 Intel Corporation. All rights reserved</small> <br>
      <small>*Other names and brands may be claimed as the property of others</small>
    </div>
</footer>
    </div>
    

      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'0.1',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/js/affix.js"></script>
        <script type="text/javascript" src="../../../_static/js/sorttable.js"></script>
        <script type="text/javascript" src="../../../_static/js/project.js"></script>

    

    
    
      <script type="text/javascript" src="../../../_static/js/theme.js"></script>
    

    
    

     <script type="text/javascript">
    jQuery(function() { Search.loadIndex("../../../searchindex.js"); });
    </script>
    
    <script type="text/javascript" id="searchindexloader"></script>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61272224-1', 'auto');
  ga('send', 'pageview');
  </script>
   
</body>
</html>
