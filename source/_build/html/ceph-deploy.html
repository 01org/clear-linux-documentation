



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Ceph*</title>
  

<link rel="icon" type="image/png" sizes="192x192" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_android_192x192.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_180x180.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_152x152.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_96x96.png" />
<meta name="google-site-verification" content="xDIK6ZRF9BKNIeBUstAHF3zS6bpi2eCjBHemCQAEH8o" />
<meta name="msapplication-TileImage" href="sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_microsoft_144x144.png" />
<meta name="theme-color" content="#7DD2F7" />
<link rel="icon" type="image/png" sizes="16x16" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_web_16x16.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_144x144.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_120x120.png" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<link rel="shortcut icon" href="/sites/all/themes/custom/clearlinux_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="apple-touch-icon" sizes="57x57" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_57x57.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_76x76.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_72x72.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_60x60.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/sites/all/themes/custom/clearlinux_theme/images/favicons/favicon_apple_114x114.png" />

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/main.css" type="text/css" />
  

  

  

    <link rel="stylesheet" href="/sites/all/themes/custom/clearlinux_theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/overrides.css" type="text/css" />
    <link rel="top" title="Documentation for Clear Linux* Project for Intel(r) Architecture" href="index.html"/>
        <link rel="up" title="Storage solutions" href="index-storage.html"/>
        <link rel="prev" title="Storage solutions" href="index-storage.html"/>
     
    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
  

  
  <script src="/sites/all/themes/custom/clearlinux_theme/js/modernizr.custom.19994.js"></script>

</head>

<body role="document" >
  <div id="wrapper">
  <header>
    <div id="o1-header">
      <div class="o1-logo-container hidden-xs">
        <div class="container"><a href="http://01.org" class="o1-logo ext" target="_blank"></a></div>
      </div>
      <div class="project-header container clearfix">
        <div class="left inline">
          <a href="/" id="project-name">
            <span id="project-name-left">Clear Linux&nbsp;</span>
            <span id="project-name-right">Project <sup>*</sup></span>
            <span id="project-name-bottom">for Intel* Architecture</span>
          </a>
        </div>
        <div class="right">
          <div class="mobile-menu"></div>
                        <div class="region region-header">
    <div id="block-system-main-menu" class="block block-system block-menu">


  <ul class="menu"><li class="first leaf"><a href="https://download.clearlinux.org" title="Downloads" target="_blank">Downloads</a></li>
<li class="collapsed"><a href="/features" title="Features">Features</a></li>
<li class="collapsed"><a href="/documentation" title="Documentation" class="active">Documentation</a></li>
</ul>
</div>
<div id="block-menu-menu-get-involved" class="block block-menu">

        <h4>Get Involved</h4>

  <ul class="menu">
    <li class="first leaf"><a href="http://freenode.net/" target="_blank">IRC #clearlinux</a></li>
<li class="leaf"><a href="https://lists.clearlinux.org/mailman/listinfo/dev">Mailing list</a></li>
<li class="last leaf"><a href="/blogs">Blogs</a></li>
</ul>
</div>
  </div>
                    <ul class="nav-tools">
            <li><a href="/search"><i class="fa fa-search"></i></a></li>
            <!--<li><i class="fa fa-mail-forward"></i></li>-->
          </ul>

      </div>
    </div>
  </div></header>
      
      <div class="main-content">
        <div id="site-breadcrumb" class="hidden-sm">
            <div class="container">





<div id="site-breadcrumb" class="hidden-sm">
  <h2 class="element-invisible"></h2>
  <div class="breadcrumb">
    <a href="/">Home</a> » <a href="index.html">Documentation</a> » Ceph*
  </div>
</div></div>
          </div>
        <div class="container clearfix">
          <div class="row">
           <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="region region-content">
              <div class="content">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-md-3 col-sm-3 col-xs-3">
                      <div class="row"><div class="col-md-12 col-sm-12 col-xs-12"><sidebar>
  <h2>Content Map</h2>
      
      
      
      
      
      
      
      
      <ul class="custom-dropdown-menu">
<li class="menu-item-closed parent-item"><a class="reference internal" href="index_gs.html">Getting started</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="gs_getting_started.html">Getting started</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="gs_supported_hardware.html">Supported hardware</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="gs_creating_bootable_usb.html">Creating a bootable USB to install the OS</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="gs_installing_clr_as_host.html">Installing the OS as host</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="gs-clear-containers-gettting-started.html">Clear Containers getting started guide</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="ciao-cluster-setup.html">Getting started with ciao</a></li>
</ul>
</li>
</ul>
<ul class="custom-dropdown-menu">
<li class="menu-item-closed parent-item"><a class="reference internal" href="index_vm.html">Running in a virtualized environment</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="vm-kvm.html">Using KVM</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="vm-virtualbox.html">Using VirtualBox</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="vm-vmware-esxi.html">Using VMware* ESXi guest</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="vm-vmware-player.html">Using VMware* Player</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="vm-hyper-v.html">Using Hyper-V</a></li>
</ul>
</li>
</ul>
<ul class="custom-dropdown-menu">
<li class="menu-item-closed parent-item"><a class="reference internal" href="index_sw_update.html">Software update</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="swupdate_about_sw_update.html">About software update</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="swupdate_how_to_run_the_updater.html">How to run the updater</a></li>
</ul>
</li>
</ul>
<ul class="custom-dropdown-menu">
<li class="menu-item-closed parent-item"><a class="reference internal" href="index_bundles.html">Bundles</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="bundles_overview.html">Bundles overview</a></li>
</ul>
</li>
</ul>
<ul class="custom-dropdown-menu">
<li class="menu-item-closed parent-item"><a class="reference internal" href="index_advanced_configuration.html">Advanced configuration</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="network_boot.html">Network booting</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="mixer.html">Mixer Tool</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="ac-dpdk.html">DPDK</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="ac-ovs-dpdk.html">OpenvSwitch and DPDK</a></li>
</ul>
</li>
</ul>
<ul class="custom-dropdown-menu">
<li class="menu-item-closed parent-item"><a class="reference internal" href="index-openstack.html">OpenStack* implementation</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="reference internal" href="openstack_use_cases.html">OpenStack* use cases with Clear Linux* OS for Intel® Architecture</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="openstack_bundle_and_service_summary.html">OpenStack* bundle and service summary</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="installing_openstack.html">Installing OpenStack*</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="configure_openstack_environment.html">Configure environment</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="openstack_env_inventory_file.html">The &#8220;hosts&#8221; file</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="openstack_conf_vars_about.html">About &#8220;group_vars/all&#8221;</a></li>
<li class="child-item first-level no-childs"><a class="reference internal" href="openstack_conf_vars_list.html">Variables for OpenStack* Deployment</a></li>
</ul>
</li>
</ul>
<ul class="custom-dropdown-menu">
<li class="menu-item-open parent-item"><a class="reference internal" href="index-storage.html">Storage solutions</a><ul class="custom-dropdown-menu">
<li class="child-item first-level no-childs"><a class="active">Ceph*</a></li>
</ul>
</li>
</ul>
<ul class="simple">
</ul>

</sidebar></div></div>
                      <div class="row"><div class="col-md-12 col-sm-12 col-xs-12">
<br />
<div id="searchbox" role="search">
  <h2>Quick Search</h2>
  <form class="search" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="submit" value="Go" class="pull-right">
  </form>
</div></div></div>
                    </div>
                    <div class="col-md-9 col-sm-9 col-xs-9">
  <div class="section" id="ceph">
<h1>Ceph*</h1>
<p>Ceph is a distributed storage system designed to scale well. It can be integrated with
OpenStack* as the storage backend for the OS images and volumes.</p>
<p>Deploying a Ceph storage cluster is simple using Clear Linux* OS for Intel® Architecture
and Ansible*.</p>
<div class="section" id="environment">
<h2>Environment</h2>
<p>For this example, we&#8217;ll use a total of five nodes: a <strong>deployment node</strong> which we will use
to run the playbooks, a <strong>monitor node</strong>, and three <strong>storage nodes</strong>.</p>
<p>Install each component on its own server for best results; however, for testing
purposes you can install the monitor and storage nodes on the same hosts.</p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites</h2>
<p>Ansible uses ssh to run commands on the remote servers. In order to do that, the servers
must be configured to allow passwordless ssh connections from the root user. Follow these
steps to configure your nodes.</p>
<ol class="arabic">
<li><p class="first">Generate ssh keys:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ssh-keygen</span>
</pre></div>
</div>
</li>
<li><p class="first">Enable root login:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># echo &quot;PermitRootLogin yes&quot; &gt;&gt; /etc/ssh/sshd_config</span>
</pre></div>
</div>
</li>
<li><p class="first">Enable sshd service:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># systemctl enable sshd</span>
<span class="c"># systemctl start sshd</span>
</pre></div>
</div>
</li>
<li><p class="first">Allow passwordless login:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ssh-copy-id root@node</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="install-the-software">
<h2>Install the software</h2>
<p>Install the <code class="docutils literal"><span class="pre">sysadmin-hostmgmt</span></code> bundle on the development node. This bundle contains
the Ansible software required to run the playbooks, as well as some Ansible roles and
sample playbooks that you can use to build your own:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># swupd bundle-add sysadmin-hostmgmt</span>
</pre></div>
</div>
</div>
<div class="section" id="create-the-playbook">
<h2>Create the playbook</h2>
<p>The <code class="docutils literal"><span class="pre">sysadmin-hostmgmt</span></code> bundle includes some sample playbooks that you may use and
customize for your own needs. Start by making a copy of the sample playbook into your
home folder.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># cp /usr/share/ansible/examples/ceph ~/</span>
</pre></div>
</div>
<p>The playbook consist of four files that you should modify to fit your needs:</p>
<div class="highlight-python"><div class="highlight"><pre>ceph
|-- group_vars/
|    |-- all
|    +-- mons
|-- hosts
+-- ceph_deploy.yml
</pre></div>
</div>
<p>The hosts file contains the IP addresses of your servers grouped under the roles
they will serve:</p>
<div class="highlight-python"><div class="highlight"><pre>[mons]
172.28.128.7

[osds]
172.28.128.8
172.28.128.9
172.28.128.10
</pre></div>
</div>
<p>This <code class="file docutils literal"><span class="pre">groups_var/all</span></code> file contains variables that will applied to all your nodes.
The mandatory variables are already there; be sure to change the values accordingly to
fit your environment. It should look something like this:</p>
<div class="highlight-python"><div class="highlight"><pre>---
journal_size: 1024
monitor_interface: enp0s8
public_network: 172.28.128.0/24
cluster_network: &quot;{{ public_network }}&quot;
</pre></div>
</div>
<p>A full list of available variables can be found under
<code class="file docutils literal"><span class="pre">/usr/share/ansible/roles/&lt;role&gt;/defaults/main.yml</span></code></p>
<p>This <code class="file docutils literal"><span class="pre">groups_var/osd</span></code> file contains variables that apply only to the hosts under the
<code class="docutils literal"><span class="pre">[mons]</span></code> section in your hosts file. You can choose one of the three available scenarios
for this playbook.</p>
<ol class="arabic">
<li><p class="first"><strong>Journal and osd_data on the same device</strong>: This will co-locate both journal and data
on the same disk, creating a partition at the beginning of the device:</p>
<div class="highlight-python"><div class="highlight"><pre>journal_collocation: true
devices:
  - /dev/sdb
  - /dev/sdc
  - /dev/sdd
</pre></div>
</div>
</li>
<li><p class="first"><strong>N journal devices for N OSDs</strong>: In this example, the <code class="docutils literal"><span class="pre">sdb</span></code> partition will be used
for journaling of <code class="docutils literal"><span class="pre">sdc</span></code> and <code class="docutils literal"><span class="pre">sdd</span> <span class="pre">sdf</span></code> will be used for journaling of <code class="docutils literal"><span class="pre">sde</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>raw_multi_journal: true
devices:
  - /dev/sdc
  - /dev/sdd
  - /dev/sde
raw_journal_devices:
  - /dev/sdb
  - /dev/sdb
  - /dev/sdf
</pre></div>
</div>
</li>
<li><p class="first"><strong>Specify directory instead of disk for OSDs</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre>osd_directory: true
osd_directories:
  - /var/lib/ceph/osd/mydir1
  - /var/lib/ceph/osd/mydir2
  - /var/lib/ceph/osd/mydir3
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="run-the-playbook">
<h2>Run the playbook</h2>
<p>Once you have your variables and hosts file configured, the deployment can be fired
with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ansible-playbook -i hosts ceph_deploy.yml</span>
</pre></div>
</div>
</div>
<div class="section" id="verify">
<h2>Verify</h2>
<p>Now that Ansible has finished with the deployment, you can verify the health of the cluster
with the Ceph utilites like <code class="docutils literal"><span class="pre">ceph</span> <span class="pre">status</span></code> and <code class="docutils literal"><span class="pre">ceph</span> <span class="pre">osd</span> <span class="pre">tree</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre># ceph status
    cluster ee1fae3b-b95b-494c-abd7-f0629d113446
     health HEALTH_OK
     monmap e1: 1 mons at {node2=172.28.128.5:6789/0}
            election epoch 2, quorum 0 node2
     osdmap e8: 3 osds: 3 up, 3 in
            flags sortbitwise
      pgmap v14: 64 pgs, 1 pools, 0 bytes data, 0 objects
            7566 MB used, 49647 MB / 59896 MB avail
                  64 active+clean
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre># ceph osd tree
ID WEIGHT  TYPE NAME      UP/DOWN REWEIGHT PRIMARY-AFFINITY
-1 0.05699 root default
-2 0.01900     host node3
 0 0.01900         osd.0       up  1.00000          1.00000
-3 0.01900     host node4
 1 0.01900         osd.1       up  1.00000          1.00000
-4 0.01900     host node5
 2 0.01900         osd.2       up  1.00000          1.00000
</pre></div>
</div>
</div>
</div>

</div>
                  </div>
                </div>
              </div>
            </div>
           </div>
          </div>
        </div>
      </div>
      <footer id="footer">
    <div class="project-footer container clearfix">
      <span class="intel-sw-logo"></span>
      <div class="mobile-menu"></div>
                <div class="region region-footer">
    <div id="block-menu-menu-footer-menu" class="block block-menu">


  <ul class="menu"><li class="first leaf"><a href="/about/privacy-policy">Privacy Policy</a></li>
<li class="leaf"><a href="mailto:dev@lists.clearlinux.org" class="mailto">Contact us</a></li>
<li class="leaf"><a href="/about/terms-service">Terms of Service</a></li>
<li class="leaf"><a href="http://www.intel.com/content/www/us/en/legal/trademarks.html" target="_blank" class="ext">* Trademarks</a></li>
<li class="last leaf"><a href="http://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html" target="_blank" class="ext">Cookies</a></li>
</ul>
</div>
<div id="block-menu-block-1" class="block block-menu-block">


  <div class="menu-block-wrapper menu-block-1 menu-name-menu-social-media parent-mlid-0 menu-level-1">
  <ul class="menu"><li class="first leaf menu-mlid-8277"><a href="https://twitter.com/clearlinux" class="social-media icon twitter">Twitter</a></li>
<li class="leaf menu-mlid-8286"><a href="https://plus.google.com/u/2/b/110130641055512104222/110130641055512104222/posts/p/pub?_ga=1.28912252.1365239857.1461340816" class="social-media icon googleplus">Google +</a></li>
<li class="last leaf menu-mlid-8279"><a href="https://github.com/clearlinux" class="social-media icon github">Github</a></li>
</ul></div>

</div>
  </div>
    </div>
    <div class="footer-copyright">
      <small>Copyright © 2016 Intel Corporation. All rights reserved</small> <br>
      <small>*Other names and brands may be claimed as the property of others</small>
    </div>
</footer>
    </div>
    

      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'0.1',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/js/affix.js"></script>
        <script type="text/javascript" src="_static/js/project.js"></script>

    

    
    
      <script type="text/javascript" src="_static/js/theme.js"></script>
    

    
    

     <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
    </script>
    
    <script type="text/javascript" id="searchindexloader"></script>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61272224-1', 'auto');
  ga('send', 'pageview');
  </script>
   
</body>
</html>
